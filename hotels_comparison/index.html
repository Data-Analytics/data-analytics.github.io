<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Administration of justice in India,Courts Data">
    <meta name="author" content="Sushanth">
    <meta http-equiv="refresh" content="600">
    <meta name="keywords" content="data-visualisation, data-analytics, javascript, d3.js, data visualisation ,treemap,tree map,image treemap,imagemap">
    <title>Hotel Analysis</title>
    <script src="jquery.min.js"></script>
	<link href="bootstrap.css" rel="stylesheet" /> 
	<link href="basic.css" rel="stylesheet" />   
	<link href="cax.css" rel="stylesheet" />   	
    <script type="text/javascript" src="bootstrap.min.js"></script>
    <script type="text/javascript" src="output.min.js"></script>
	<style>
	text {
    font-size: 60%;
	}
	.sub_header {
		background-color: #F4B903;
		padding: 8px 6px;
		margin: 5px 0 20px 0; 
		color: white;
		font-weight: 100;
		text-align: center;
		font-size: 30px;
	}
	rect.bordered {
        stroke: #E6E6E6;
        stroke-width:2px;   
      }

      text.mono {
        font-size: 9pt;
        font-family: Consolas, courier;
        fill: #aaa;
      }

      text.axis-workweek {
        fill: #000;
      }

      text.axis-worktime {
        fill: #000;
      }
	</style>
	<h1 class="sub_header">Hotel Analysis</h1>
    <script type="text/javascript" src="d3.v3.min.js"></script>
	<script type="text/javascript" src="heat_map.js"></script>	
	
	<div class="container">
	<p class="form-inline">
    <label value="Data_set">Comparison Against: </label>		
    <select id="options_type">   
        <option value="os_data" class="name">Intent against Operating System</option>
        <option value="browser_data" class="name">Intent against Browsers</option>
        <option value="refferer_data" class="name">Intent against Refferals</option>
    </select>	
    <label value="Select_Chart">Chart Type : </label>
	<select id="options_view">   
        <option value="horizontal_stacked_bar" class="name">horizontal stacked bar</option>
        <option value="stacked_bar" class="name">stacked bar</option>
        <option value="normalized_stacked_bar" class="name">normalized stacked bar</option>
        <option value="marimekko" class="name">marimekko</option>
        <option value="grouped_bar" class="name">grouped bar</option>
    </select>
   <button id ="submit" value="submit" class="btn btn-primary" onClick='onRender();' >submit</button>
   </p>
	<div id="page-wrapper">
    <div id="page-inner">
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-default">
                    <div align="center" class="panel-heading">
                        Intent Analysis
                    </div>
					<div class="panel-body">
					<div id="marimekkomap"></div>
				    </div>
				</div>
			</div>
	</div>
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-default">
                    <div align="center" class="panel-heading">
                        Day And Hour Analysis
                    </div>
					<div class="panel-body">
					<div id="chart"></div>
				    </div>
				</div>
			</div>
	</div>	
	</div>
	</div>
<p class="form-inline">
    <label value="Data_set">Comparison Against: </label>		
    <select id="options_type_area">   
        <option value="os_date" class="name">Intent against Operating System</option>
        <option value="browser_date" class="name">Intent against Browsers</option>
        <option value="refferer_date" class="name">Intent against Refferals</option>
    </select>	
    <label value="Select_Chart">Chart Type : </label>
	<select id="options_view_area">   
        <option value="stacked_area" class="name">stacked area</option>
        <option value="normalized_stacked_area" class="name">normalized stacked area</option>
    </select>
   <button id ="submit" value="submit" class="btn btn-primary" onClick='onAreaRender();' >submit</button>
   </p>
	<div id="page-wrapper">
    <div id="page-inner">
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-default">
                    <div align="center" class="panel-heading">
                        Date Wise Analysis
                    </div>
					<div class="panel-body">
					<div id="area"></div>
				    </div>
				</div>
			</div>
	</div>
	</div>
	</div>   
	</div>	
    <script type="text/javascript">
 onRender();
 onAreaRender(); 

function onAreaRender() {   
	var elems = $('#options_view_area').val();
	var types = $('#options_type_area').val();

	 d3.select('#area').select("svg")
       .remove();

		if ( types == 'os_date' ) {
			col_values = ['Android','iOS','Mac','Others','Windows']
		} else if ( types == 'browser_date' ) {
			col_values = ['Chrome','Firefox','MSIE','Others','Safari']
		} else if ( types == 'refferer_date' ) {
			col_values = ['Bing','Google','jupitor_hotel','Others','Yahoo']
		}	
		
	d3.csv(types+".csv", function(pivot) {
		var options = {
		width: 1200,
		height: 500,
		container: "#area",
		data: pivot,
		groupby :'Date',
		date_format :"%d-%m-%Y",
		values : col_values,
		color:d3.scale.category10()
		};
		
		if ( elems == 'normalized_stacked_area' ) {
			normalized_stacked_area.make(options);
		} else if ( elems == 'stacked_area' ) {
			stacked_area.make(options);
		} 
		
	});
	  
}
 
function onRender() {   
	var elem = $('#options_view').val();
	var type = $('#options_type').val();

	 d3.select('#marimekkomap').select("svg")
       .remove();

		if ( type == 'os_data' ) {
			col_values = ['Android','iOS','Mac','Others','Windows']
		} else if ( type == 'browser_data' ) {
			col_values = ['Chrome','Firefox','MSIE','Others','Safari']
		} else if ( type == 'refferer_data' ) {
			col_values = ['Bing','Google','jupitor_hotel','Others','Yahoo']
		}	
			
	d3.csv(type+".csv", function(pivot) {
		var options = {
		width: 1200,
		height: 500,
		container: "#marimekkomap",	
		data: pivot,
		groupby :'intent',
		values : col_values,
		color:d3.scale.category10()
		};
		
		if ( elem == 'normalized_stacked_bar' ) {
			normalized_stacked_bar.make(options);
		} else if ( elem == 'stacked_bar' ) {
			stacked_bar.make(options);
		} else if ( elem == 'horizontal_stacked_bar' ) {
			horizontal_stacked_bar.make(options);
		} else if ( elem == 'marimekko' ) {
			marimekko.make(options);
		} else if ( elem == 'grouped_bar' ) {
			grouped_bar.make(options);	
		}
		
	});
	  
}

	
	
	var margin = { top: 40, right: 20, bottom: 50, left: 20 },
    width = 960 - margin.left - margin.right,
    height = 420 - margin.top - margin.bottom,
    gridSize = Math.floor(width / 24),
    legendElementWidth = gridSize*2,
    buckets = 9,
    colors = ['#ccffcc','#99ff99','#66ff66','#33ff33','#00ff00','#00cc00','#009900','#006600','#003300'] 
    days = ["Mo", "Tu", "We", "Th", "Fr", "Sa", "Su"],
    times = ["1a", "2a", "3a", "4a", "5a", "6a", "7a", "8a", "9a", "10a", "11a", "12a", "1p", "2p", "3p", "4p", "5p", "6p", "7p", "8p", "9p", "10p", "11p", "12p"];

      d3.csv("data.csv",
        function(d) {
          return {
            day: +d.day,
            hour: +d.hour,
            value: +d.value
          };
        },
        function(error, data) {
          var colorScale = d3.scale.quantile()
              .domain([0, buckets - 1, d3.max(data, function (d) { return d.value; })])
              .range(colors);

          var svg = d3.select("#chart").append("svg")
              .attr("width", width + margin.left + margin.right)
              .attr("height", height + margin.top + margin.bottom)
              .append("g")
              .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

          var dayLabels = svg.selectAll(".dayLabel")
              .data(days)
              .enter().append("text")
                .text(function (d) { return d; })
                .attr("x", 0)
                .attr("y", function (d, i) { return i * gridSize; })
                .style("text-anchor", "end")
                .attr("transform", "translate(-6," + gridSize / 1.5 + ")")
                .attr("class", function (d, i) { return ((i >= 0 && i <= 4) ? "dayLabel mono axis axis-workweek" : "dayLabel mono axis"); });

          var timeLabels = svg.selectAll(".timeLabel")
              .data(times)
              .enter().append("text")
                .text(function(d) { return d; })
                .attr("x", function(d, i) { return i * gridSize; })
                .attr("y", 0)
                .style("text-anchor", "middle")
                .attr("transform", "translate(" + gridSize / 2 + ", -6)")
                .attr("class", function(d, i) { return ((i >= 7 && i <= 16) ? "timeLabel mono axis axis-worktime" : "timeLabel mono axis"); });

          var heatMap = svg.selectAll(".hour")
              .data(data)
              .enter().append("rect")
              .attr("x", function(d) { return (d.hour - 1) * gridSize; })
              .attr("y", function(d) { return (d.day - 1) * gridSize; })
              .attr("rx", 2)
              .attr("ry", 2)
              .attr("width", gridSize)
              .attr("height", gridSize)
              .style("fill", function(d) { return colorScale(d.value); })
              .style("stroke", "#ccc")
              .attr('data-title',function(d) { return 'Users : '+d.value; });
              
        $("rect").tooltip({container: 'body', html: true, placement:'right'});        
      });
    </script>
  </body>
</html>

