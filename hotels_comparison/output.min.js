function addThousandsSeparator(t){var a=t;if(parseFloat(t)){t=new String(t);var e=t.split(".");e[0]=e[0].split("").reverse().join("").replace(/(\d{3})(?!$)/g,"$1,").split("").reverse().join(""),a=e.join(".")}return a}calendar={make:function(t){function a(t){var a=new Date(t.getFullYear(),t.getMonth()+1,0),e=+o(t),r=+i(t),d=+o(a),l=+i(a);return"M"+(r+1)*n+","+e*n+"H"+r*n+"V"+7*n+"H"+l*n+"V"+(d+1)*n+"H"+(l+1)*n+"V0H"+(r+1)*n+"Z"}void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=105),void 0==t.cellSize&&(t.cellSize=12),void 0==t.container&&(t.container="body"),void 0==t.date_format&&(t.date_format="%Y-%m-%d"),void 0==t.start_year&&(t.start_year=2010),void 0==t.end_year&&(t.end_year=2013),void 0==t.range&&(t.range=["white","steelblue"]),void 0==t.date&&(t.date="date"),void 0==t.value&&(t.value="value"),void 0==t.data&&(t.data={});var e=t.width,r=t.height,n=t.cellSize;week_days=["sun","mon","tue","wed","thu","fri","sat"],month=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"];var o=d3.time.format("%w"),i=d3.time.format("%U"),d=d3.format(".1%"),l=d3.time.format(t.date_format),u=d3.scale.linear().range(t.range).domain([0,1]),c=d3.select(t.container).selectAll("svg").data(d3.range(t.start_year,t.end_year+1)).enter().append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).attr("class","RdYlGn").append("g").attr("transform","translate("+(e-53*n)/2+","+(r-7*n-1)+")");c.append("text").attr("transform","translate(-38,"+3.5*n+")rotate(-90)").style("text-anchor","middle").text(function(t){return t});for(var s=0;s<week_days.length;s++)c.append("text").attr("transform","translate(-5,"+n*(s+1)+")").style("text-anchor","end").attr("dy","-.25em").text(function(t){return week_days[s]});var h=c.selectAll(".day").data(function(t){return d3.time.days(new Date(t,0,1),new Date(t+1,0,1))}).enter().append("rect").attr("class","day").attr("width",n).attr("height",n).attr("x",function(t){return i(t)*n}).attr("y",function(t){return o(t)*n}).attr("fill","#fff").datum(l);c.selectAll(".month").data(function(t){return d3.time.months(new Date(t,0,1),new Date(t+1,0,1))}).enter().append("path").attr("class","month").attr("id",function(t,a){return month[a]}).attr("d",a),c.selectAll(".month").append("text").attr("class",function(t,a){return month[a]}).style("text-anchor","end").attr("dy","-.25em").text(function(t,a){return month[a]}),t.data.forEach(function(a){a[t.value]=parseInt(a[t.value])});var p=d3.max(t.data,function(a){return a[t.value]}),f=d3.nest().key(function(a){return a[t.date]}).rollup(function(a){return a[0][t.value]/p}).map(t.data);h.filter(function(t){return t in f}).attr("fill",function(t){return u(f[t])}).attr("data-title",function(t){return t+": "+d(f[t])}),$("rect").tooltip({container:"body",html:!0,placement:"right"})}},treemap={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.container&&(t.container="body"),void 0==t.color&&(t.color="color"),void 0==t.groupby&&(t.groupby="groupby"),void 0==t.size&&(t.size="value"),void 0==t.data&&(t.data={});var a=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).attr("xmlns","http://www.w3.org/2000/svg").attr("xlink","http://www.w3.org/1999/xlink").attr("version","1.1"),e=d3.layout.treemap().padding(.5).size([t.width,t.height]).sticky(!0).value(function(a){return a[t.size]}).children(function(t){return t.values});data_root={key:"treemap"};var r=d3.nest().key(function(a){return a[t.groupby]}).entries(t.data);data_root.values=r;a.data([data_root]).selectAll("g").data(e.nodes).enter().append("rect").attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("width",function(t){return t.dx}).attr("height",function(t){return t.dy}).attr("data-title",function(a){return"<p>"+a[t.groupby]+" : "+a[t.size]+"</p>"}).style("fill",function(a){return a[t.color]}).style("stroke","#fff").style("stroke-width",.5);$("rect").tooltip({container:"body",html:!0,placement:"top"})}},cloud={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=300),void 0==t.height&&(t.height=300),void 0==t.font&&(t.font="sans-serif"),void 0==t.container&&(t.container="body"),void 0==t.text&&(t.text="text"),void 0==t.size&&(t.size="size"),void 0==t.words&&(t.words=[{text:"This",size:40},{text:"is",size:40},{text:"an",size:40},{text:"Example",size:40}]),void 0==t.fill&&(t.fill=d3.scale.category20());var a=d3.max(t.words,function(a){return a[t.size]});t.words.forEach(function(e){e[t.size]=100*parseInt(e[t.size]/a)}),d3.layout.cloud().size([t.width,t.height]).words(t.words).rotate(function(t){return 90*~~(2*Math.random())}).font(t.font).fontSize(function(a){return a[t.size]}).on("end",function(a){d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).attr("xmlns","http://www.w3.org/2000/svg").attr("xlink","http://www.w3.org/1999/xlink").attr("version","1.1").append("g").attr("transform","translate("+t.width/2+","+t.height/2+")").selectAll("text").data(a).enter().append("text").style("font-size",function(a){return a[t.size]+"px"}).style("font-family",t.font).style("fill",function(a,e){return t.fill(e)}).attr("text-anchor","middle").attr("transform",function(t){return"translate("+[t.x,t.y]+")rotate("+t.rotate+")"}).attr("data-title",function(a){return a[t.text]+" : "+a[t.size]}).text(function(a){return a[t.text]}),$("text").tooltip({container:"body",html:!0,placement:"top"})}).start()}},sankey={make:function(t){function a(t){d3.select(this).attr("transform","translate("+t.x+","+(t.y=Math.max(0,Math.min(height-t.dy,d3.event.y)))+")"),r.relayout(),o.attr("d",n)}void 0==t&&(t={}),void 0==t.width&&(t.width=1200),void 0==t.height&&(t.height=900),void 0==t.container&&(t.container="body"),void 0==t.nodeWidth&&(t.nodeWidth=100),void 0==t.nodePadding&&(t.nodePadding=3),void 0==t.source&&(t.source="source"),void 0==t.target&&(t.target="target"),void 0==t.value&&(t.value="value"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.data&&(t.data={});var e=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+(t.width+20)+" "+(t.height+20)).attr("xmlns","http://www.w3.org/2000/svg").attr("xlink","http://www.w3.org/1999/xlink").attr("transform","translate(10,20)").attr("version","1.1");width=t.width;var r=d3.sankey().nodeWidth(t.nodeWidth).nodePadding(t.nodePadding).size([t.width,t.height]),n=r.link();graph={nodes:[],links:[]},name_list=[],t.data.forEach(function(a){name_list.push(a.source),graph.nodes.push({name:a[t.source]}),graph.nodes.push({name:a[t.target]}),graph.links.push({source:a[t.source],target:a[t.target],value:+parseInt(a[t.value])})}),graph.nodes=d3.keys(d3.nest().key(function(t){return t.name}).map(graph.nodes)),graph.links.forEach(function(t,a){graph.links[a].source=graph.nodes.indexOf(graph.links[a].source),graph.links[a].target=graph.nodes.indexOf(graph.links[a].target)}),graph.nodes.forEach(function(t,a){graph.nodes[a]={name:t}}),r.nodes(graph.nodes).links(graph.links).layout(32);var o=e.append("g").selectAll(".link").data(graph.links).enter().append("path").attr("class","link").attr("d",n).style("stroke-width",function(t){return Math.max(1,t.dy)}).sort(function(t,a){return a.dy-t.dy}).attr("data-title",function(t){return t.source.name+" vs "+t.target.name+"\n"+t.value}),i=e.append("g").selectAll(".node").data(graph.nodes).enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+t.x+","+t.y+")"}).call(d3.behavior.drag().origin(function(t){return t}).on("dragstart",function(){this.parentNode.appendChild(this)}).on("drag",a));i.append("rect").attr("height",function(t){return t.dy}).attr("width",r.nodeWidth()).style("fill",function(a,e){return t.color(e)}).style("stroke",function(a){return d3.rgb(t.color).darker(2)}).attr("data-title",function(t){return t.name+"\n"+t.value}),$("rect").tooltip({container:"body",html:!0,placement:"top"}),$("path").tooltip({container:"body",html:!0,placement:"top"}),i.append("text").attr("x",-6).attr("y",function(t){return t.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(t){return t.name.charAt(0).toUpperCase()+t.name.slice(1)}).filter(function(a){return a.x<t.width/2}).attr("x",6+r.nodeWidth()).attr("text-anchor","start")}},forcelayout={make:function(t){function a(){f.attr("transform",function(t){return"translate("+t.x+","+t.y+")"}),p.attr("x1",function(t){return t.source.x}).attr("y1",function(t){return t.source.y}).attr("x2",function(t){return t.target.x}).attr("y2",function(t){return t.target.y})}function e(t){d3.select(this).classed("fixed",t.fixed=!1)}function r(t){d3.select(this).classed("fixed",t.fixed=!0)}function n(t){return u[t]||(u[t]={name:t,group:0})}function o(t){return u[t]||(u[t]={name:t,group:1})}void 0==t&&(t={}),void 0==t.width&&(t.width=1200),void 0==t.height&&(t.height=900),void 0==t.container&&(t.container="body"),void 0==t.charge&&(t.charge=-160),void 0==t.linkDistance&&(t.linkDistance=80),void 0==t.radius&&(t.radius=70),void 0==t.source&&(t.source="source"),void 0==t.target&&(t.target="target"),void 0==t.value&&(t.value="value"),void 0==t.data&&(t.data={}),void 0==t.color&&(t.color=d3.scale.category10());var i=d3.select(t.container).append("svg").attr("width",t.width).attr("height",t.height).attr("xmlns","http://www.w3.org/2000/svg").attr("xlink","http://www.w3.org/1999/xlink").style("width","100%").attr("data-height","0.54").attr("viewBox","0 0 "+t.width+" "+t.height).attr("version","1.1"),d=d3.fisheye.circular().radius(t.radius),l=d3.layout.force().charge(t.charge).linkDistance(t.linkDistance).size([t.width,t.height]),u={};t.data.forEach(function(a){a[t.value]=parseFloat(a[t.value])}),l.nodes(h).links(t.data);var c=l.drag().on("dragstart",r),s=d3.nest().entries(t.data);s.forEach(function(a){a.source=n(a[t.source]),a.target=o(a[t.target])});var h=d3.values(u),p=i.selectAll(".link").data(s).enter().append("line").attr("class","link").style("stroke-width",1.5).attr("data-title",function(a){return a[t.value]}).attr("stroke","steelblue"),f=i.selectAll(".node").data(h).enter().append("g").attr("class","node").on("dblclick",e);f.append("rect").attr("fill",function(a,e){return t.color(e)}).attr("stroke",function(a){return d3.rgb(t.color).darker(2)}).style("stroke-width",1.5).attr("x",-10).attr("y",-10).attr("width",20).attr("height",20).attr("rx",10).attr("data-title",function(t){return t.name}).on("mouseover",function(t){v(t)}).on("mouseout",function(t){m(t)}).call(c);var g=f.append("text").attr("text-anchor","start").attr("sub_link",function(t){return t.name}).text(function(t){return t.name}).style("opacity",0);$("rect").tooltip({container:"body",html:!0,placement:"top"}),$("line").tooltip({container:"body",html:!0,placement:"top"}),l.nodes(h).links(s).on("tick",a).start(),i.on("mousemove",function(){d.focus(d3.mouse(this)),f.each(function(t){t.fisheye=d(t)}).attr("transform",function(t){return"translate("+t.fisheye.x+","+t.fisheye.y+")"}),p.attr("x1",function(t){return t.source.fisheye.x}).attr("y1",function(t){return t.source.fisheye.y}).attr("x2",function(t){return t.target.fisheye.x}).attr("y2",function(t){return t.target.fisheye.y})});var v=function(t){var a={};a[t.index]=!0,p.filter(function(e){return e.source==t?(a[e.target.index]=!0,!0):e.target==t?(a[e.source.index]=!0,!0):!1}).style("stroke-width",3),f.filter(function(t){return a[t.index]}).style("stroke-width",2),g.filter(function(t){return a[t.index]}).style("opacity",1)},m=function(t){p.style("stroke-width",1.5),f.style("stroke-width",1.5),g.style("opacity",0)}}},bar_pie={make:function(t){function a(a,e){function r(t){return u[t]}function n(a){function r(a){var r=e.filter(function(e){return e[t.groupby]==a[0]})[0],n=d3.keys(r.freq).map(function(t){return{type:t,freq:r.freq[t]}});p.update(n),f.update(n)}function n(t){p.update(c),f.update(c)}var o={},i={t:60,r:0,b:30,l:0};i.w=450-i.l-i.r,i.h=300-i.t-i.b;var l=d3.select(t.container_bar).append("svg").attr("width","100%").attr("data-height","0.58").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+i.l+","+i.t+")"),u=d3.scale.ordinal().rangeRoundBands([0,i.w],.1).domain(a.map(function(t){return t[0]}));l.append("g").attr("class","x axis").attr("transform","translate(0,"+i.h+")").call(d3.svg.axis().scale(u).orient("bottom"));var s=d3.scale.linear().range([i.h,0]).domain([0,d3.max(a,function(t){return t[1]})]),h=l.selectAll(".bar").data(a).enter().append("g").attr("class","bar");return h.append("rect").attr("x",function(t){return u(t[0])}).attr("y",function(t){return s(t[1])}).attr("width",u.rangeBand()).attr("height",function(t){return i.h-s(t[1])}).attr("fill",d).attr("stroke",d3.rgb(d).darker()).on("mouseover",r).on("mouseout",n),h.append("text").text(function(t){return d3.format(",")(t[1])}).attr("x",function(t){return u(t[0])+u.rangeBand()/2}).attr("y",function(t){return s(t[1])-5}).attr("text-anchor","middle"),o.update=function(t,a){s.domain([0,d3.max(t,function(t){return t[1]})]);var e=l.selectAll(".bar").data(t);e.select("rect").transition().duration(500).attr("y",function(t){return s(t[1])}).attr("height",function(t){return i.h-s(t[1])}).attr("fill",a),e.select("text").transition().duration(500).text(function(t){return d3.format(",")(t[1])}).attr("y",function(t){return s(t[1])-5})},o}function o(a){function n(a){h.update(e.map(function(e){return[e[t.groupby],e.freq[a.data.type]]}),r(a.data.type))}function o(a){h.update(e.map(function(a){return[a[t.groupby],a.total]}),d)}function i(t){var a=d3.interpolate(this._current,t);return this._current=a(0),function(t){return s(a(t))}}var l={},u={w:500,h:390};u.r=Math.min(u.w,u.h)/2;var c=d3.select(t.container_pie).append("svg").attr("width","100%").attr("data-height","0.58").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+u.w/2+","+u.h/2+")"),s=d3.svg.arc().outerRadius(u.r-10).innerRadius(0),p=d3.layout.pie().sort(null).value(function(t){return t.freq});return c.selectAll("path").data(p(a)).enter().append("path").attr("d",s).each(function(t){this._current=t}).style("fill",function(t){return r(t.data.type)}).on("mouseover",n).on("mouseout",o),l.update=function(t){c.selectAll("path").data(p(t)).transition().duration(500).attrTween("d",i)},l}function i(a){function e(t,a){return d3.format("%")(t.freq/d3.sum(a.map(function(t){return t.freq})))}var n={},o=d3.select(t.container_legend).append("table").attr("class","table table-bordered"),i=o.append("tbody").selectAll("tr").data(a).enter().append("tr");return i.append("td").append("svg").attr("width","16").attr("height","16").append("rect").attr("width","16").attr("height","16").attr("fill",function(t){return r(t.type)}),i.append("td").text(function(t){return t.type}),i.append("td").attr("class","legendFreq").text(function(t){return d3.format(",")(t.freq)}),i.append("td").attr("class","legendPerc").text(function(t){return e(t,a)}),n.update=function(t){var a=o.select("tbody").selectAll("tr").data(t);a.select(".legendFreq").text(function(t){return d3.format(",")(t.freq)}),a.select(".legendPerc").text(function(a){return e(a,t)})},n}combined_list=t.values;var d="steelblue",l=t.color,u={};combined_list.forEach(function(t,a){u[t]=l(a)}),e.forEach(function(t){var a={};combined_list.forEach(function(e,r){a[e]=parseInt(t[e])}),t.freq=a,t.total=0,combined_list.forEach(function(a){t.total=t.total+t.freq[a]})});var c=combined_list.map(function(t){return{type:t,freq:d3.sum(e.map(function(a){return a.freq[t]}))}}),s=e.map(function(a){return[a[t.groupby],a.total]}),h=n(s),p=o(c),f=i(c)}void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.container_bar&&(t.container_bar="body"),void 0==t.container_pie&&(t.container_pie="body"),void 0==t.container_legend&&(t.container_legend="body"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.values&&(t.values=["A","B","C","D"]),void 0==t.groupby&&(t.groupby="groupby"),void 0==t.data&&(t.data={}),a("#dashboard",t.data)}},pyramid={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.container&&(t.container="body"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.value&&(t.value="value"),void 0==t.text&&(t.text="text"),void 0==t.data&&(t.data={});t.width;height=t.height,mid_point=Math.min(t.width,t.height)/2,area=Math.pow(Math.min(t.width,t.height),2)/2,color=t.color;var a=d3.select(t.container).append("svg").attr("width",t.width).attr("height",t.height).attr("width","100%").attr("data-height","0.58").attr("viewBox","0 0 "+t.width+" "+t.height);t.data.forEach(function(a){a[t.value]=+a[t.value]}),t.data.sort(function(a,e){return d3.ascending(a[t.value],e[t.value])}),console.log(t.data);for(var e=0,r=0;r<t.data.length;r++)t.data[r].area=e+t.data[r][t.value],e+=t.data[r][t.value];t.data.sort(function(a,e){return d3.descending(a[t.value],e[t.value])}),rollup=d3.nest().key(function(t){return t.nos}).rollup(function(a){return d3.sum(a,function(a){return a[t.value]})}).entries(t.data),rollup.forEach(function(t){sub_area=area/t.values});for(var n=0,r=0;r<t.data.length;r++)t.data[r].sl_no=n++,t.data[r].nos=1,t.data[r].sub_area=Math.sqrt(2*t.data[r].area*sub_area).toFixed(2);for(var r=0;r<t.data.length;r++)t.data[r].pos_1=mid_point-t.data[r].sub_area/2,t.data[r].pos_2=mid_point+t.data[r].sub_area/2;var o=a.selectAll(".arc").data(t.data).enter().append("g").attr("class","arc");o.append("path").attr("d",function(t){return"M"+mid_point.toString()+" 0 L"+t.pos_1.toString()+" "+t.sub_area.toString()+" L"+t.pos_2.toString()+" "+t.sub_area.toString()+" Z"}).style("fill",function(t){return color(t.sl_no)}).attr("data-title",function(a){return a[t.text]+": "+a[t.value]}).style("stroke",function(t){return d3.rgb(color(t.sl_no)).darker()}),$("path").tooltip({container:"body",html:!0,placement:"bottom"})}},sunburst={make:function(t){function a(t){if(a=t.parent){var a,r=a.x,o=.8;a.children.forEach(function(n){r+=e(n,r,n===t?a.dx*o/t.value:a.dx*(1-o)/(a.value-t.value))})}else e(t,0,t.dx/t.value);path.transition().duration(750).attrTween("d",n)}function e(t,a,r){if(t.x=a,t.children&&(n=t.children.length))for(var n,o=-1;++o<n;)a+=e(t.children[o],a,r);return t.dx=t.value*r}function r(t){t.x0=t.x,t.dx0=t.dx}function n(t){var a=d3.interpolate({x:t.x0,dx:t.dx0},t);return function(e){var r=a(e);return t.x0=r.x,t.dx0=r.dx,i(r)}}void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.radius&&(t.radius=190),void 0==t.container&&(t.container="body"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.value&&(t.value="value"),void 0==t.text_1&&(t.text_1="text"),void 0==t.text_2&&(t.text_2="text_2"),void 0==t.data&&(t.data={}),t.data.forEach(function(a){a[t.value]=parseInt(a[t.value])});var o=d3.layout.partition().size([2*Math.PI,t.radius]).value(function(a){return a[t.value]}),i=d3.svg.arc().startAngle(function(t){return t.x}).endAngle(function(t){return t.x+t.dx}).innerRadius(function(t){return t.y}).outerRadius(function(t){return t.y+t.dy}),d=d3.select(t.container).append("svg").attr("width",t.width).attr("height",t.height).attr("width","100%").attr("data-height","0.58").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+t.width/2+","+t.height/2+")"),l={key:"Origin Data",values:d3.nest().key(function(a){return a[t.text_1]}).entries(t.data)},u={key:"Origin Data",children:l.values.map(function(t){return{key:t.key,children:t.values}})};addup=-1,path=d.data([u]).selectAll("path").data(o.nodes).enter().append("path").attr("d",i).style("fill",function(a){return a.children?(addup+=1,t.color(addup)):d3.rgb(t.color(addup)).darker(2)}).attr("data-title",function(a){return a.children?a.key:a[t.text_2]+":"+parseInt(a[[t.value]])}).on("click",a).each(r),$("path").tooltip({container:"body",html:!0,placement:"top"})}},marimekko={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.container&&(t.container="body"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.values&&(t.values=["A","B","C","D"]),void 0==t.groupby&&(t.groupby="groupby"),void 0==t.data&&(t.data={});var a={top:t.height/10,left:t.width/10},e=d3.scale.linear().range([0,t.width-a.left-a.left]),r=d3.scale.linear().range([0,t.height-a.top]),n=d3.format(",d"),o=d3.format("%"),i=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+a.left/2+","+a.top/2+")"),d=d3.scale.ordinal().range(t.color.range());d.domain(t.values),segments_group=[],t.data.forEach(function(a){segments_group.push(d.domain().map(function(e){return{name:e,value:+a[e],group:a[t.groupby]}}))}),s=[],segments_group.forEach(function(t){let_group=[],t.forEach(function(t){let_group.push({name:t.name,value:t.value}),group=t.group}),s.push({key:group,values:let_group})});var l=s.reduce(function(t,a){return(a.offset=t)+(a.sum=a.values.reduceRight(function(t,e){return e.parent=a,(e.offset=t)+e.value},0))},0),u=i.selectAll(".x").data(e.ticks(10)).enter().append("g").attr("class","x").attr("transform",function(t){return"translate("+e(t)+","+r(0)+")"});u.append("line").attr("y2",6).style("stroke","#000"),u.append("text").attr("y",-10).attr("text-anchor","middle").attr("dy",".71em").text(o);var c=i.selectAll(".y").data(r.ticks(10)).enter().append("g").attr("class","y").attr("transform",function(t){return"translate(0,"+r(1-t)+")"});c.append("line").attr("x1",-6).style("stroke","#000"),c.append("text").attr("x",-8).attr("text-anchor","end").attr("dy",".35em").text(o);var s=i.selectAll(".names").data(s).enter().append("g").attr("class","names").attr("transform",function(t){return"translate("+e(t.offset/l)+")"}),h=(s.selectAll(".group").data(function(t){return t.values}).enter().append("rect").attr("y",function(t){return r(t.offset/t.parent.sum)}).attr("height",function(t){return r(t.value/t.parent.sum)}).attr("width",function(t){return e(t.parent.sum/l)-1}).attr("stroke",function(a){return d3.rgb(t.color(a.name)).darker()}).attr("data-title",function(t){return t.name+" - "+t.parent.key+": "+n(t.value)}).style("fill",function(a){return t.color(a.name)}),i.selectAll(".legend").data(t.values).enter().append("g").attr("class","legend").attr("transform",function(t,a){return"translate(0,"+20*a+")"}));h.append("rect").attr("x",t.width-a.left+8).attr("width",18).attr("height",18).style("fill",d),h.append("text").attr("x",t.width-a.left).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t}),$("rect").tooltip({container:"body",html:!0,placement:"top"})}},bubble={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=300),void 0==t.height&&(t.height=300),void 0==t.font&&(t.font="sans-serif"),void 0==t.container&&(t.container="body"),void 0==t.text&&(t.text="text"),void 0==t.size&&(t.size="size"),void 0==t.data&&(t.data={}),void 0==t.color&&(t.color=d3.scale.category20());var a=(Math.min(t.width,t.height),t.color),e=d3.layout.pack().sort(null).size([t.width,t.height]).padding(1.5),r=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).attr("class","bubble");data=t.data.map(function(a){return a.value=+a[t.size],a});var n=e.nodes({children:data}).filter(function(t){return!t.children}),o=r.append("g").attr("transform","translate(0,0)").selectAll(".bubble").data(n).enter();o.append("circle").attr("r",function(t){return t.r}).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}).style("fill",function(t){return a(t.value)}).style("stroke",function(t){return d3.rgb(a(t.value)).darker()}).attr("data-title",function(a){return a[t.text]+" : "+a.value}),o.append("text").attr("x",function(t){return t.x}).attr("y",function(t){return t.y+5}).attr("text-anchor","middle").text(function(a){return a[t.text].substring(0,a.r/3)}).style({fill:"white","font-family":t.font,"font-size":"12px"}).attr("data-title",function(a){return a[t.text]+" : "+a.value}),$("circle").tooltip({container:"body",html:!0,placement:"left"}),$("text").tooltip({container:"body",html:!0,placement:"top"})}},aster_plot={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.container&&(t.container="body"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.value&&(t.value="value"),void 0==t.weight&&(t.weight="weight"),void 0==t.text&&(t.text="text"),void 0==t.data&&(t.data={});var a=d3.max(t.data,function(a){return a[t.value]}),e=Math.min(t.width,t.height)/2,r=.3*e,n=d3.layout.pie().sort(null).value(function(a){return a[t.weight]}),o=d3.svg.arc().innerRadius(r).outerRadius(function(a){return(e-r)*(a.data[t.value]/100)+r}),i=d3.svg.arc().innerRadius(r).outerRadius(e),d=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+t.width/2+","+t.height/2+")");t.data.forEach(function(e){e._display_value=e[t.value],e[t.value]=parseFloat(e[t.value])/parseFloat(a)*100,e[t.weight]=+e[t.weight]});var l=(d.selectAll(".solidArc").data(n(t.data)).enter().append("path").attr("fill",function(a,e){return t.color(e)}).attr("data-title",function(a,e){return t.data[e][t.text]+" : "+t.data[e]._display_value}).attr("class","solidArc").attr("stroke","gray").attr("d",o),d.selectAll(".outlineArc").data(n(t.data)).enter().append("path").attr("fill","none").attr("stroke","gray").attr("class","outlineArc").attr("d",i),t.data.reduce(function(a,e){return a+e[t.value]*e[t.weight]},0)/t.data.reduce(function(a,e){return a+e[t.weight]},0));d.append("svg:text").attr("class","aster-score").attr("dy",".35em").attr("text-anchor","middle").attr("font-weight","bold").attr("font-size","500%").text(Math.round(l)),$("path").tooltip({container:"body",html:!0,placement:"top"})}},donut={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.container&&(t.container="body"),void 0==t.innerRadius&&(t.innerRadius=0),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.value&&(t.value="value"),void 0==t.text&&(t.text="text"),void 0==t.data&&(t.data={});var a=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+t.width/2+","+t.height/2+")"),e=Math.min(t.width,t.height)/2;t.data.forEach(function(a){a[t.value]=+a[t.value]});var r=d3.svg.arc().outerRadius(e).innerRadius(t.innerRadius),n=d3.layout.pie().sort(null).value(function(a){return a[t.value]}),o=a.selectAll(".arc").data(n(t.data)).enter().append("g").attr("class","arc");o.append("path").attr("d",r).style("fill",function(a,e){return t.color(e)}).attr("data-title",function(a,e){return a.data[t.text]+" : "+a.data[t.value]}),o.append("text").attr("transform",function(t){return"translate("+r.centroid(t)+")"}).attr("dy",".35em").text(function(a){return a.data[t.text]}),$("path").tooltip({container:"body",html:!0,placement:"top"})}},stacked_bar={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.container&&(t.container="body"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.values&&(t.values=["A","B","C","D"]),void 0==t.groupby&&(t.groupby="groupby"),void 0==t.data&&(t.data={});var a={top:t.height/10,left:t.width/10},e=d3.scale.ordinal().rangeRoundBands([0,t.width-a.left-a.left],.1),r=d3.scale.linear().rangeRound([t.height-a.top,0]),n=d3.scale.ordinal().range(t.color.range()),o=d3.svg.axis().scale(e).orient("bottom"),i=d3.svg.axis().scale(r).orient("left").tickFormat(d3.format(".2s")),d=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+a.left/2+","+a.top/2+")");n.domain(t.values),t.data.forEach(function(a){var e=0;a.groups=n.domain().map(function(r){return{name:r,y0:e,y1:e+=+a[r],value:a[r],groupby:a[t.groupby]}}),a.total=a.groups[a.groups.length-1].y1}),e.domain(t.data.map(function(a){return a[t.groupby]})),r.domain([0,d3.max(t.data,function(t){return t.total})]),d.append("g").attr("class","x axis").attr("transform","translate(0,"+(t.height-a.top)+")").call(o),d.append("g").attr("class","y axis").call(i).append("text").attr("transform","rotate(-90)").attr("y",2).attr("dy",".71em").style("text-anchor","end").text("Percentage");var l=d.selectAll(".stackedbar").data(t.data).enter().append("g").attr("class","g").attr("transform",function(a){return"translate("+e(a[t.groupby])+",0)"});l.selectAll("rect").data(function(t){return t.groups}).enter().append("rect").attr("width",e.rangeBand()).attr("y",function(t){return r(t.y1)}).attr("height",function(t){return r(t.y0)-r(t.y1)}).attr("data-title",function(t){return t.groupby+","+t.name+" "+t.value}).style("fill",function(t){return n(t.name)});var u=d.selectAll(".legend").data(n.domain().slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(t,a){return"translate(0,"+20*a+")"});u.append("rect").attr("x",t.width-a.left+8).attr("width",18).attr("height",18).style("fill",n),u.append("text").attr("x",t.width-a.left).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t}),$("rect").tooltip({container:"body",html:!0,placement:"top"})}},normalized_stacked_bar={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.container&&(t.container="body"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.values&&(t.values=["A","B","C","D"]),void 0==t.groupby&&(t.groupby="groupby"),void 0==t.data&&(t.data={});var a={top:t.height/10,left:t.width/10},e=d3.scale.ordinal().rangeRoundBands([0,t.width-a.left-a.left],.1),r=d3.scale.linear().rangeRound([t.height-a.top,0]),n=d3.scale.ordinal().range(t.color.range()),o=d3.svg.axis().scale(e).orient("bottom"),i=d3.svg.axis().scale(r).orient("left").tickFormat(d3.format(".2s")),d=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+a.left/2+","+a.top/2+")");n.domain(t.values),t.data.forEach(function(a){var e=0;a.groups=n.domain().map(function(r){return{name:r,y0:e,y1:e+=+a[r],value:a[r],groupby:a[t.groupby]}}),a.groups.forEach(function(t){t.y0/=e,t.y1/=e,t.y0=100*t.y0,t.y1=100*t.y1}),a.total=a.groups[a.groups.length-1].y1}),t.data.sort(function(t,a){return a.total-t.total}),e.domain(t.data.map(function(a){return a[t.groupby]})),r.domain([0,d3.max(t.data,function(t){return t.total})]),d.append("g").attr("class","x axis").attr("transform","translate(0,"+(t.height-a.top)+")").call(o),d.append("g").attr("class","y axis").call(i).append("text").attr("transform","rotate(-90)").attr("y",2).attr("dy",".71em").style("text-anchor","end").text("Percentage");var l=d.selectAll(".stackedbar").data(t.data).enter().append("g").attr("class","g").attr("transform",function(a){return"translate("+e(a[t.groupby])+",0)"});l.selectAll("rect").data(function(t){return t.groups}).enter().append("rect").attr("width",e.rangeBand()).attr("y",function(t){return r(t.y1)}).attr("height",function(t){return r(t.y0)-r(t.y1)}).attr("data-title",function(t){return t.groupby+","+t.name+" "+t.value}).style("fill",function(t){return n(t.name)});var u=d.selectAll(".legend").data(n.domain().slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(t,a){return"translate(0,"+20*a+")"});u.append("rect").attr("x",t.width-a.left+8).attr("width",18).attr("height",18).style("fill",n),u.append("text").attr("x",t.width-a.left).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){
return t}),$("rect").tooltip({container:"body",html:!0,placement:"top"})}},grouped_bar={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.container&&(t.container="body"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.values&&(t.values=["A","B","C","D"]),void 0==t.groupby&&(t.groupby="groupby"),void 0==t.data&&(t.data={});var a={top:t.height/10,left:t.width/10},e=d3.scale.ordinal().rangeRoundBands([0,t.width-a.left-a.left],.1),r=d3.scale.ordinal(),n=d3.scale.linear().rangeRound([t.height-a.top,0]),o=d3.scale.ordinal().range(t.color.range()),i=d3.svg.axis().scale(e).orient("bottom"),d=d3.svg.axis().scale(n).orient("left").tickFormat(d3.format(".2s")),l=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+a.left/2+","+a.top/2+")");o.domain(t.values),t.data.forEach(function(a){a.groups=o.domain().map(function(e){return{name:e,value:+a[e],groupby:a[t.groupby]}})}),e.domain(t.data.map(function(a){return a[t.groupby]})),r.domain(t.values).rangeRoundBands([0,e.rangeBand()]),n.domain([0,d3.max(t.data,function(t){return d3.max(t.groups,function(t){return t.value})})]),l.append("g").attr("class","x axis").attr("transform","translate(0,"+(t.height-a.top)+")").call(i),l.append("g").attr("class","y axis").call(d);var u=l.selectAll(".state").data(t.data).enter().append("g").attr("class","g").attr("transform",function(a){return"translate("+e(a[t.groupby])+",0)"});u.selectAll("rect").data(function(t){return t.groups}).enter().append("rect").attr("width",r.rangeBand()).attr("x",function(t){return r(t.name)}).attr("y",function(t){return n(t.value)}).attr("data-title",function(t){return t.groupby+","+t.name+" "+t.value}).attr("height",function(e){return t.height-n(e.value)-a.top}).style("fill",function(t){return o(t.name)});var c=l.selectAll(".legend").data(t.values).enter().append("g").attr("class","legend").attr("transform",function(t,a){return"translate(0,"+20*a+")"});c.append("rect").attr("x",t.width-a.left+8).attr("width",18).attr("height",18).style("fill",o),c.append("text").attr("x",t.width-a.left).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t}),$("rect").tooltip({container:"body",html:!0,placement:"top"})}},dual_scale_bar={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.container&&(t.container="body"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.groupby&&(t.groupby="groupby"),void 0==t.value_1&&(t.value_1="value_1"),void 0==t.value_2&&(t.value_2="value_2"),void 0==t.data&&(t.data={});var a={top:t.height/10,left:t.width/10},e=d3.scale.ordinal().rangeRoundBands([0,t.width-a.left-a.left],.1),r=d3.svg.axis().scale(e).orient("bottom"),n=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+a.left/2+","+a.top/2+")"),o=d3.scale.linear().domain([0,d3.max(t.data,function(a){return a[t.value_1]})]).range([t.height-a.top,0]),i=d3.scale.linear().domain([0,d3.max(t.data,function(a){return a[t.value_2]})]).range([t.height-a.top,0]),d=d3.svg.axis().scale(o).ticks(5).orient("left"),l=d3.svg.axis().scale(i).ticks(6).orient("right");e.domain(t.data.map(function(a){return a[t.groupby]})),o.domain([0,d3.max(t.data,function(a){return a[t.value_1]})]),n.append("g").attr("class","x axis").attr("transform","translate(0,"+(t.height-a.top)+")").call(r),n.append("g").attr("class","y axis axisLeft").attr("transform","translate(0,0)").call(d).attr("fill",function(a){return t.color(0)}).append("text").attr("y",6).attr("dy","-2em").style("text-anchor","end").attr("fill",function(a){return t.color(0)}).text(t.value_1),n.append("g").attr("class","y axis axisRight").attr("transform","translate("+(t.width-a.left-a.left)+",0)").attr("fill",function(a){return t.color(1)}).call(l).append("text").attr("y",6).attr("dy","-2em").attr("dx","2em").style("text-anchor","end").attr("fill",function(a){return t.color(1)}).text(t.value_2),bars=n.selectAll(".bar").data(t.data).enter(),bars.append("rect").attr("class","bar1").attr("x",function(a){return e(a[t.groupby])}).attr("width",e.rangeBand()/2).attr("rx",e.rangeBand()/8).attr("y",function(a){return o(a[t.value_1])}).attr("height",function(e){return t.height-o(e[t.value_1])-a.top}).attr("fill",function(a){return t.color(0)}).attr("data-title",function(a){return t.value_1+" : "+a[t.value_1]}),bars.append("rect").attr("class","bar2").attr("x",function(a){return e(a[t.groupby])+e.rangeBand()/2}).attr("width",e.rangeBand()/2).attr("rx",e.rangeBand()/8).attr("y",function(a){return i(a[t.value_2])}).attr("height",function(e){return t.height-i(e[t.value_2])-a.top}).attr("fill",function(a){return t.color(1)}).attr("data-title",function(a){return t.value_2+" : "+a[t.value_2]}),$("rect").tooltip({container:"body",html:!0,placement:"right"})}},bubble_axis={make:function(t){function a(a){return a[t.xAxis]}function e(a){return a[t.yAxis]}function r(a){return a[t.size]}function n(t){t.attr("cx",function(t){return d(a(t))}).attr("cy",function(t){return l(e(t))}).attr("r",function(t){return u(r(t))})}function o(t,a){return r(a)-r(t)}void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.container&&(t.container="body"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.size&&(t.size="size"),void 0==t.groupby&&(t.groupby="groupby"),void 0==t.xAxis&&(t.xAxis="xAxis"),void 0==t.yAxis&&(t.yAxis="yAxis"),void 0==t.data&&(t.data={});var i={top:t.height/10,left:t.width/10};max_xAxis=d3.max(t.data,function(a){return a[t.xAxis]}),max_yAxis=d3.max(t.data,function(a){return a[t.yAxis]}),max_radiusScale=d3.max(t.data,function(a){return a[t.size]}),min_radiusScale=d3.min(t.data,function(a){return a[t.size]}),max_radiusScale==min_radiusScale?ranges=50:ranges=4;var d=d3.scale.linear().domain([0,max_xAxis]).range([0,t.width-2*i.left]),l=d3.scale.linear().domain([0,max_yAxis]).range([t.height-2*i.top,0]),u=d3.scale.sqrt().domain([0,"1e"+(max_radiusScale.toString().length+1).toString()]).range([0,ranges]),c=t.color,s=d3.svg.axis().orient("bottom").scale(d),h=d3.svg.axis().scale(l).orient("left"),p=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+i.left+","+i.top+")");p.append("g").attr("class","x axis").attr("transform","translate(0,"+(t.height-2*i.top)+")").call(s),p.append("g").attr("class","y axis").call(h);d3.bisector(function(t){return t[0]}),p.append("g").attr("class","dots").selectAll(".dot").data(t.data).enter().append("circle").attr("class","dot").style("fill",function(t,a){return c(a)}).style("stroke","#444").call(n).sort(o).attr("data-title",function(a){return a[t.groupby]+" : "+addThousandsSeparator(a[t.size])});$("circle").tooltip({container:"body",html:!0,placement:"top"})}},horizontal_stacked_bar={make:function(t){void 0==t&&(t={}),void 0==t.width&&(t.width=960),void 0==t.height&&(t.height=500),void 0==t.values&&(t.values=["A","B","C","D"]),void 0==t.container&&(t.container="body"),void 0==t.color&&(t.color=d3.scale.category10()),void 0==t.groupby&&(t.groupby="groupby"),void 0==t.data&&(t.data={});var a={top:t.height/10,left:t.width/10},e=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+a.left+","+a.top/2+")"),r=d3.layout.stack()(t.values.map(function(a){return t.data.map(function(e){return{x:e[t.groupby],y:parseFloat(e[a]),value:parseFloat(e[a]),name:a}})})),n=(d3.max(r,function(t){return d3.max(t,function(t){return t.y})}),d3.max(r,function(t){return d3.max(t,function(t){return t.y0+t.y})})),o=d3.scale.ordinal().domain(r[0].map(function(t){return t.x})).rangeRoundBands([25,t.height-a.top],.2),i=d3.scale.linear().domain([0,n]).range([0,t.width-a.left]),d=d3.scale.ordinal().range(t.color.range());d.domain(t.values);var l=d3.svg.axis().scale(i).orient("bottom").tickPadding(12),u=d3.svg.axis().scale(o).tickSize(0).tickPadding(6).orient("left"),c=e.selectAll(".layer").data(r).enter().append("g").attr("class","layer");d3.selectAll(".tick > text").style("font-size","12px");c.selectAll("rect").data(function(t){return t}).enter().append("rect").attr("y",function(t){return o(t.x)}).attr("height",o.rangeBand()).attr("x",function(t){return i(t.y0)}).attr("width",function(t){return i(t.y)}).style("fill",function(t){return d(t.name)}).style("stroke",function(t){return d3.rgb(d(t.name)).darker()}).attr("data-title",function(t){return t.x+","+t.name+" "+t.value});e.append("g").attr("class","x axis").attr("transform","translate(0,"+t.height+")").call(l).selectAll("text").style("text-anchor","start").attr("dx","-.18em").attr("dy",".15em"),e.append("g").attr("class","y axis").attr("transform","translate(0,0)").call(u);var s=e.selectAll(".legend").data(t.values).enter().append("g").attr("class","legend").attr("transform",function(t,a){return"translate(0,"+20*a+")"});s.append("rect").attr("x",t.width-3*a.left/2+8).attr("width",18).attr("height",18).style("fill",d),s.append("text").attr("x",t.width-3*a.left/2).attr("y",9).attr("dy",".35em").style("text-anchor","end").text(function(t){return t}),$("rect").tooltip({container:"body",html:!0,placement:"top"})}},correlation={make:function(t){function a(t){d3.select(this).selectAll(".cell").data(t.filter(function(t){return t.z})).enter().append("rect").attr("class","cell").attr("x",function(t){return n(t.x)}).attr("width",n.rangeBand()).attr("height",n.rangeBand()).attr("data-title",function(t){return t.x+","+t.y+","+data.nodes[t.x]+","+data.nodes[t.y]+" : "+t.z.toFixed(2)}).style("fill",function(t){return t.x>t.y?o(t.z):"#fff"}),d3.select(this).selectAll(".texts").data(t.filter(function(t){return t.z})).enter().append("text").attr("x",function(t){return n(t.x)+23}).attr("y",31).style("text-anchor","middle").attr("data-title",function(t){return t.x+","+t.y+","+data.nodes[t.x]+","+data.nodes[t.y]+" : "+t.z.toFixed(2)}).text(function(t){return t.x>t.y?t.z.toFixed(2):void 0})}void 0==t&&(t={}),void 0==t.width&&(t.width=1200),void 0==t.height&&(t.height=900),void 0==t.container&&(t.container="body"),void 0==t.source&&(t.source="source"),void 0==t.target&&(t.target="target"),void 0==t.value&&(t.value="value"),void 0==t.data&&(t.data={});var e={top:t.height/10,left:t.width/10},r=d3.select(t.container).append("svg").attr("width","100%").attr("data-height","0.5678").attr("viewBox","0 0 "+t.width+" "+t.height).append("g").attr("transform","translate("+e.left+","+e.top+")"),n=d3.scale.ordinal().rangeBands([0,t.width-e.left]),o=(d3.scale.linear().domain([0,4]).clamp(!0),d3.scale.linear().range(["white","steelblue"]));data={nodes:[],links:[]},t.data.forEach(function(a){data.nodes.push({name:a[t.source],group:1}),data.nodes.push({name:a[t.target],group:1}),data.links.push({source:a[t.source],target:a[t.target],value:parseFloat(a[t.value])})}),data.nodes=d3.keys(d3.nest().key(function(t){return t.name}).map(data.nodes)),data.links.forEach(function(t,a){data.links[a].source=data.nodes.indexOf(data.links[a].source),data.links[a].target=data.nodes.indexOf(data.links[a].target)});var i=[],d=data.nodes,l=d.length;d.forEach(function(t,a){t.index=a,t.count=0,i[a]=d3.range(l).map(function(t){return{x:t,y:a,z:0}})}),console.log(d),data.links.forEach(function(t){i[t.source][t.target].z+=t.value,i[t.target][t.source].z+=t.value,i[t.source][t.source].z+=t.value,i[t.target][t.target].z+=t.value,d[t.source].count+=t.value,d[t.target].count+=t.value}),n.domain(data.nodes),r.append("rect").attr("class","background").attr("width",t.width).attr("height",t.height);var a=r.selectAll(".row").data(i).enter().append("g").attr("class","row").attr("transform",function(t,a){return"translate(0,"+n(a)+")"}).each(a);a.append("line").attr("x2",t.width);var u=r.selectAll(".column").data(i).enter().append("g").attr("class","column").attr("transform",function(t,a){return"translate("+n(a)+")rotate(-90)"});u.append("line").attr("x1",-t.width),u.append("text").attr("x",6).attr("y",n.rangeBand()/2).attr("dy",".32em").attr("text-anchor","start").text(function(t,a){return data.nodes[a]}),$("rect").tooltip({container:".correlation",html:!0,placement:"top"})}};