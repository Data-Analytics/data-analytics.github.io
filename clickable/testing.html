<html>
 <head>
  <meta http-equiv="X-UA-COMPATIBLE" content="IE=EmulateIE9">
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <meta name="author" content="Sushanth">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Undecided voters hold key in 2016 Tamil Nadu Assembly elections 'A visual guide to the check out the history of Tamil Nadu Assembly elections, from 1967 until 2011', Which of the Dravidian duos might get the stronghold in Tamil Nadu? What will be the pre-poll alliances? For the state January is a crucial month to predict next political face.">
  <meta name="news_keywords" content="tamil nadu polls, tamil nadu assembly polls, jayalalithaa, chennai floods, tamil nadu elections, tamil nadu assembly elections, chennai news, tamil nadu news, india news">
  <meta name="keywords" content="tamil nadu polls, tamil nadu assembly polls, jayalalithaa, chennai floods, tamil nadu elections, tamil nadu assembly elections, chennai news, tamil nadu news, india news">  
  <link href="css/basic.css" rel="stylesheet">
  <link href="css/feature.css" rel="stylesheet">
  <link href="css/custom-styles.css" rel="stylesheet">
  <script type="text/javascript" src="js/jquery.min.js"></script>  
  <script type="text/javascript" src="js/d3.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>
  <link href="css/bootstrap.css" rel="stylesheet">    
  <meta property="og:title"  content="ASSEMBLY ELECTIONS 1967 - 2011 (TAMIL NADU)" /> 
  <meta property="og:url"   content="http://data-analytics.github.io/Election_Data/tamil_nadu.html" /> 
  <meta property="og:description" content="Undecided voters hold key in 2016 Tamil Nadu Assembly elections 'A visual guide to the check out the history of Tamil Nadu Assembly elections, from 1967 until 2011'" /> 
  <meta property="og:image" content="images/images.png" /> 
  <html itemscope itemtype="http://schema.org/Blog">
  <meta itemprop="description" content="Undecided voters hold key in 2016 Tamil Nadu Assembly elections 'A visual guide to the check out the history of Tamil Nadu Assembly elections, from 1967 until 2011'">
  <meta itemprop="name" content="ASSEMBLY ELECTIONS 1967 - 2011 (TAMIL NADU)">
  <meta itemprop="image" content="images/images.png">
  <title>Assembly Elections 2011 (Tamil Nadu)</title>
</head>
<body>
<div class="geo_map">
<svg data-height="0.54" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 1750 1200" style="width: 100%;">
<g class="geomaps" transform="translate(200,80)">
</div>						
<script>
function addThousandsSeparator(input) {
    var output = input
    if (parseFloat(input)) {
    input = new String(input); 
    var parts = input.split("."); 
    parts[0] = parts[0].split("").reverse().join("").replace(/(\d{3})(?!$)/g, "$1,").split("").reverse().join("");
    output = parts.join(".");
    }

    return output;
} 

function detail_view(acct_no){

d3.csv("color_mapper.csv", function(error_color, color_data) {

color_map = {}
color_data.forEach(function (d) {
	color_map[d.party] = d.color;
});
		
	d3.csv("assembly_tn_detail.csv", function(data_csv) {
	
	data_set = data_csv.filter(function(d){return (d.YEAR==2011)& (d.AC_NAME==acct_no)& (d.rank<12) })
	
	var margin = {top: 10, right: 30, bottom: 15, left: 60},
				width = 860 - margin.left - margin.right,
				height = 320 - margin.top - margin.bottom;
	
	var horizontal_bar_svg = d3.select(".geo_map").select("svg").append("g")
										.attr("class", "clear")
										.attr("transform", "translate(1040,200)");
							
	var constituency_name = '';
	
    data_set.forEach(function(o) {
		constituency_name = o.AC_NAME;
	  });
    	  
	var layers = d3.layout.stack()(['VOTES'].map(function(period) {
	    return data_set.map(function(d) {
		  return {x: d['rank']+': '+d.PARTY, y: parseFloat(d[period]), votes: parseFloat(d[period]), color : d.color, party:d.PARTY,constituency:d.AC_NAME,name:d.NAME,polled_votes:d.polled_votes };
		});
    }));

   var yGroupMax = d3.max(layers, function(layer) { return d3.max(layer, function(d) { return d.y; }); });

    var yScale = d3.scale.ordinal()
        .domain(layers[0].map(function(d) { return d.x; }))
        .rangeRoundBands([0, height- margin.top - margin.bottom], .2);

    var x = d3.scale.linear()
        .domain([0, yGroupMax])
        .range([0, width-(margin.left*5/2)]);

	var color = d3.scale.ordinal()
		.range(["#7aa1c2","#72d8f2","#f3daa4","#66ca9b","#f7f7f7","#f7f7f7"]);
	
    var xAxis = d3.svg.axis()
        .scale(x)
        .orient("bottom")		
        .tickPadding(12)
		.ticks(4);
		
    var yAxis = d3.svg.axis()
        .scale(yScale)
        .tickSize(0)
        .tickPadding(9)
        .orient("left");

	  horizontal_bar_svg.selectAll(".head_id")
		  .data([acct_no])
		  .enter().append("text")				  
		  .attr("x", 310)
		  .attr("y", -25)
		  .attr("dy",".35em")
		  .attr("font-size","25px")
		  .style("text-anchor","middle")
		  .attr("fill", "#444")
			.text(function(d) { return d });
			
    var layer = horizontal_bar_svg.selectAll(".layer")
        .data(layers)
        .enter().append("g")
        .attr("class", "layer");
		
		d3.selectAll(".tick > text")
			.style("font-size", "13px")	
  
    var rect = layer.selectAll("rect")
        .data(function(d) { return  d; })
        .enter().append("rect")
        .attr("y", function(d) { return yScale(d.x); })
        .attr("height", yScale.rangeBand())
        .attr("x", function(d) { return  x(d.y0); })
        .attr("width", function(d) { return x(d.y); })
		.attr("data-title",function(d) { return 'Constituency : '+d.constituency+' <br/> Candidate : '+d.name+' <br/> party : '+d.party+' <br/> percentage : '+(parseFloat((d.votes/d.polled_votes))*100).toFixed(2)+'%  <br/> votes : '+addThousandsSeparator(d.votes)+'<br/> polled votes : '+addThousandsSeparator(d.polled_votes)+''})
		.style("fill", function(d,i) { return color_map[d.party]; })
		.style("stroke", function(d,i) { return d3.rgb(color_map[d.party]).darker(); });
      
	var rect = layer.selectAll("text")
        .data(function(d) { return  d; })
        .enter().append("text")
        .attr("y", function(d) { return yScale(d.x)+(yScale.rangeBand()*4/5); })
        .attr("x", function(d) { return  x(d.y)+3; })
        .style("text-anchor", "start")
		.attr("fill", "#444")
		.style("font-size","13px")
		.text(function(d) { return addThousandsSeparator(d.votes)+' votes'; })
		
    horizontal_bar_svg.append("g")
        .attr("class", "x axis")
        .attr("transform", "translate(0," + (height -margin.bottom - margin.top) + ")")
        .call(xAxis)
		.selectAll("text").style("text-anchor", "middle")
            .attr("dx", "-.18em")
            .attr("dy", ".15em")
			.style("fill", "rgb(99, 99, 99)")
			.style("font-size","13px")

	horizontal_bar_svg.append("text")
		.attr("x", width-margin.left-margin.left-margin.right)
		.attr("y", height-(margin.top/2)-35)
		.style("fill", "rgb(99, 99, 99)")
		.style("font-size","13px")
		.style("text-anchor", "end")
		.text("Votes");
			  
    horizontal_bar_svg.append("g")
        .attr("class", "y axis")
        .attr("transform", "translate(0,0)")
        .call(yAxis)
		.selectAll("text")
			.style("fill", "rgb(99, 99, 99)")
			.style("font-size","13px");
	
	$("rect").tooltip({container: 'body', html: true, placement:'top'});
	
	});
	
	
});
}

detail_view('Andhiyur');
		
</script>
</html>