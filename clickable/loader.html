{% code %}
import pandas as pd 

mapper = pd.read_csv('file_mapper.csv')
old = pd.read_csv('overall_detail.csv')
old = old[(old['rank']==1) & (old['YEAR']==2011)]
old = old.set_index('AC_NAME')

sub_data = []
for index,row in mapper.iterrows():
	sub_data.append(pd.read_csv(row['url']))
data = pd.concat(sub_data,ignore_index=True)
data = data[(data['votes']>1)]

ranked_data = []
for k in data['constituency'].unique():
	select_data = data[(data['constituency']==k)]
	select_data['votes'] = [int(j) for j in select_data['votes']]
	select_data.sort(['votes'], ascending=[False], inplace=True)
	select_data['rank'] = [(j+1) for j in xrange(len(select_data))]
	ranked_data.append(select_data)	
all_data = pd.concat(ranked_data,ignore_index=True)	
all_data['name'] = all_data['candidate']

all_data = all_data.set_index('constituency')
all_data['old_party'] = old['PARTY']
all_data.reset_index().to_csv('real_time.csv',index=False)
{% end %}
<!DOCTYPE html>
<!-------------------------------------------------------------
 Name:        data-analytics.github.io
 Purpose:     Data visualisation and analytics examples 
 Author:      sushanth
 Created:     28-01-2016
 Modified:    28-03-2016
 Copyright:  (c) sushanth 2016
 Licence:     protected
--------------------------------------------------------------->
<html>
 <head>
  <meta http-equiv="X-UA-COMPATIBLE" content="IE=EmulateIE9">
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <meta name="author" content="Sushanth">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Undecided voters hold key in 2016 Tamil Nadu Assembly elections 'A visual guide to the check out the history of Tamil Nadu Assembly elections, from 1967 until 2011', Which of the Dravidian duos might get the stronghold in Tamil Nadu? What will be the pre-poll alliances? For the state January is a crucial month to predict next political face.">
  <meta name="news_keywords" content="tamil nadu polls, tamil nadu assembly polls, jayalalithaa, chennai floods, tamil nadu elections, tamil nadu assembly elections, chennai news, tamil nadu news, india news">
  <meta name="keywords" content="tamil nadu polls, tamil nadu assembly polls, jayalalithaa, chennai floods, tamil nadu elections, tamil nadu assembly elections, chennai news, tamil nadu news, india news">
  <link href="css/bootstrap.css" rel="stylesheet">    
  <link href="css/basic.css" rel="stylesheet">
  <link href="css/feature.css" rel="stylesheet">
  <link href="css/custom-styles.css" rel="stylesheet">
  <script type="text/javascript" src="js/jquery.min.js"></script>  
  <script type="text/javascript" src="js/d3.js"></script>
  <script type="text/javascript" src="js/bootstrap.min.js"></script>    
  <meta property="og:title"  content="ASSEMBLY ELECTIONS 1967 - 2011 (TAMIL NADU)" /> 
  <meta property="og:url"   content="http://data-analytics.github.io/Election_Data/tamil_nadu.html" /> 
  <meta property="og:description" content="Undecided voters hold key in 2016 Tamil Nadu Assembly elections 'A visual guide to the check out the history of Tamil Nadu Assembly elections, from 1967 until 2011'" /> 
  <meta property="og:image" content="images/images.png" /> 
  <html itemscope itemtype="http://schema.org/Blog">
  <meta itemprop="description" content="Undecided voters hold key in 2016 Tamil Nadu Assembly elections 'A visual guide to the check out the history of Tamil Nadu Assembly elections, from 1967 until 2011'">
  <meta itemprop="name" content="ASSEMBLY ELECTIONS 1967 - 2011 (TAMIL NADU)">
  <meta itemprop="image" content="images/images.png">
</head>
<body>
<script>
setInterval(function() {
               	window.location.reload();
            }, 4000); 
</script>
</body>
</html>